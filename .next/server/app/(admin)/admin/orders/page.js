(()=>{var e={};e.id=841,e.ids=[841],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},9348:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o});var r=s(7096),a=s(6132),i=s(7284),l=s.n(i),d=s(2564),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(t,n);let o=["",{children:["(admin)",{children:["admin",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6605)),"/Users/mbam22022/Downloads/Slick Website/app/(admin)/admin/orders/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9753)),"/Users/mbam22022/Downloads/Slick Website/app/(admin)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,5345)),"/Users/mbam22022/Downloads/Slick Website/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/mbam22022/Downloads/Slick Website/app/(admin)/admin/orders/page.tsx"],x="/(admin)/admin/orders/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(admin)/admin/orders/page",pathname:"/admin/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9647:(e,t,s)=>{Promise.resolve().then(s.bind(s,7244))},7244:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>AdminOrdersPage});var r=s(784),a=s(9885),i=s(1440),l=s.n(i),d=s(5995),n=s(4393);function AdminOrdersPage(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[o,c]=(0,a.useState)(""),[x,m]=(0,a.useState)("all"),p=(0,d.e)(),h=(0,a.useCallback)(async(e=!1)=>{let s="admin:orders";if(!e){let e=n.V.get(s);if(e){console.log("Using cached orders data"),t(e),i(!1);return}}try{let{data:e,error:r}=await p.from("orders").select("id, order_number, total_amount, status, payment_status, shipping_address, created_at, updated_at").order("created_at",{ascending:!1});if(r)throw r;let a=e||[];if(0===a.length){t([]),n.V.set(s,[],3e4);return}let i=a.map(e=>e.id),{data:l,error:d}=await p.from("order_items").select("id, order_id, product_name, product_price, quantity, size").in("order_id",i);if(d)throw d;let o={};(l||[]).forEach(e=>{let t=o[e.order_id]||[];t.push({id:e.id,product_name:e.product_name,price:e.product_price,quantity:e.quantity,size:e.size}),o[e.order_id]=t});let c=a.map(e=>({...e,order_items:o[e.id]||[]}));t(c),n.V.set(s,c,3e4)}catch(e){try{console.error("Failed to fetch orders:",JSON.stringify(e))}catch{console.error("Failed to fetch orders:",e)}c("Failed to load orders")}finally{i(!1)}},[p]);(0,a.useEffect)(()=>{h()},[h]);let updateOrderStatus=async(e,s)=>{try{let{error:r}=await p.rpc("update_order_status",{p_order_id:e,p_status:s,p_notes:"Status updated by admin"});if(r)throw r;n.V.delete("admin:orders"),t(t=>t.map(t=>t.id===e?{...t,status:s}:t))}catch(e){console.error("Failed to update order status:",e),alert("Failed to update order status")}},deleteOrder=async e=>{try{let s=window.confirm("Delete this order? This cannot be undone.");if(!s)return;let{error:r}=await p.from("orders").delete().eq("id",e);if(r)throw r;n.V.delete("admin:orders"),t(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete order:",e),alert("Failed to delete order")}},getStatusColor=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},u="all"===x?e:e.filter(e=>e.status===x);return s?r.jsx("div",{className:"min-h-screen bg-slate-900",children:r.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-white/20 rounded mb-8"}),r.jsx("div",{className:"h-64 bg-white/20 rounded"})]})})}):r.jsx("div",{className:"min-h-screen bg-slate-900",children:(0,r.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-6 lg:mb-8",children:[(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 lg:mb-8",children:[(0,r.jsxs)("div",{className:"mb-4 lg:mb-0",children:[r.jsx("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-black text-white mb-2 lg:mb-4 tracking-tight",children:"Order Management"}),r.jsx("p",{className:"text-white/70 text-sm sm:text-base lg:text-lg",children:"Manage and track all customer orders"})]}),r.jsx("div",{className:"text-left lg:text-right",children:(0,r.jsxs)("div",{className:"text-xs sm:text-sm font-medium text-white",children:[u.length," Total Orders"]})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-3 mb-6 lg:mb-8",children:[(0,r.jsxs)("button",{onClick:()=>m("all"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-xl sm:rounded-2xl font-semibold transition-all duration-300 text-xs sm:text-sm ${"all"===x?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-500/25":"bg-white/10 text-white hover:bg-white/20 backdrop-blur-sm"}`,children:["All (",e.length,")"]}),(0,r.jsxs)("button",{onClick:()=>m("pending"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-xl sm:rounded-2xl font-semibold transition-all duration-300 text-xs sm:text-sm ${"pending"===x?"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white shadow-lg shadow-yellow-500/25":"bg-white/10 text-white hover:bg-white/20 backdrop-blur-sm"}`,children:["Pending (",e.filter(e=>"pending"===e.status).length,")"]}),(0,r.jsxs)("button",{onClick:()=>m("processing"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-xl sm:rounded-2xl font-semibold transition-all duration-300 text-xs sm:text-sm ${"processing"===x?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-500/25":"bg-white/10 text-white hover:bg-white/20 backdrop-blur-sm"}`,children:["Processing (",e.filter(e=>"processing"===e.status).length,")"]}),(0,r.jsxs)("button",{onClick:()=>m("shipped"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-xl sm:rounded-2xl font-semibold transition-all duration-300 text-xs sm:text-sm ${"shipped"===x?"bg-gradient-to-r from-purple-500 to-purple-600 text-white shadow-lg shadow-purple-500/25":"bg-white/10 text-white hover:bg-white/20 backdrop-blur-sm"}`,children:["Shipped (",e.filter(e=>"shipped"===e.status).length,")"]}),(0,r.jsxs)("button",{onClick:()=>m("delivered"),className:`px-3 sm:px-6 py-2 sm:py-3 rounded-xl sm:rounded-2xl font-semibold transition-all duration-300 text-xs sm:text-sm ${"delivered"===x?"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg shadow-green-500/25":"bg-white/10 text-white hover:bg-white/20 backdrop-blur-sm"}`,children:["Delivered (",e.filter(e=>"delivered"===e.status).length,")"]})]})]}),o&&r.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-200 p-4 rounded-lg mb-6",children:o}),r.jsx("div",{className:"hidden md:block bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl overflow-hidden shadow-xl",children:(0,r.jsxs)("div",{className:"overflow-x-auto",children:[(0,r.jsxs)("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-white/5",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Order"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Customer"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Items"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Total"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Date"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs sm:text-sm font-black text-white uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-white/10",children:u.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-white/5 align-top",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm sm:text-base font-black text-white",children:e.order_number}),r.jsx("div",{className:"text-xs text-gray-300",children:new Date(e.created_at).toLocaleDateString()})]})}),r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm font-semibold text-white",children:e.shipping_address?.name||"Guest"}),r.jsx("div",{className:"text-xs text-gray-300",children:e.shipping_address?.email||"No email"})]})}),r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"text-sm text-white",children:[e.order_items.length," item(s)"]})}),r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"text-sm font-black text-blue-300",children:["₱",e.total_amount.toLocaleString()]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"text-sm text-gray-300",children:new Date(e.created_at).toLocaleDateString()})}),r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(l(),{href:`/order/${e.id}`,className:"text-blue-400 hover:text-blue-300 font-semibold",children:"View"}),(0,r.jsxs)("select",{value:e.status,onChange:t=>updateOrderStatus(e.id,t.target.value),className:"bg-white/10 text-white border border-white/20 rounded px-2 py-1 text-xs",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"processing",children:"Processing"}),r.jsx("option",{value:"shipped",children:"Shipped"}),r.jsx("option",{value:"delivered",children:"Delivered"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]}),r.jsx("button",{onClick:()=>deleteOrder(e.id),className:"text-red-400 hover:text-red-300 font-semibold",children:"Delete"})]})})]},e.id))})]}),0===u.length&&r.jsx("div",{className:"text-center py-12",children:r.jsx("p",{className:"text-gray-300 text-lg",children:"all"===x?"No orders found":`No ${x} orders found`})})]})}),r.jsx("div",{className:"md:hidden space-y-4",children:u.map(e=>(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl p-4 shadow-xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-base font-black text-white",children:e.order_number}),r.jsx("div",{className:"text-xs text-gray-300",children:new Date(e.created_at).toLocaleDateString()})]}),r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),r.jsx("div",{className:"text-sm text-white mb-1",children:e.shipping_address?.name||"Guest"}),r.jsx("div",{className:"text-xs text-gray-300 mb-3",children:e.shipping_address?.email||"No email"}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-300",children:[e.order_items.length," item(s)"]}),(0,r.jsxs)("div",{className:"text-base font-black text-blue-300",children:["₱",e.total_amount.toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx(l(),{href:`/order/${e.id}`,className:"flex-1 text-center bg-white/10 text-white border border-white/20 rounded px-3 py-2 text-sm font-semibold",children:"View"}),r.jsx("button",{onClick:()=>deleteOrder(e.id),className:"px-3 py-2 text-sm font-semibold text-red-300 border border-red-400/40 rounded",children:"Delete"})]}),(0,r.jsxs)("select",{value:e.status,onChange:t=>updateOrderStatus(e.id,t.target.value),className:"bg-white/10 text-white border border-white/20 rounded px-3 py-2 text-sm",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"processing",children:"Processing"}),r.jsx("option",{value:"shipped",children:"Shipped"}),r.jsx("option",{value:"delivered",children:"Delivered"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]},e.id))})]})})}},6605:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>n});var r=s(5153);let a=(0,r.createProxy)(String.raw`/Users/mbam22022/Downloads/Slick Website/app/(admin)/admin/orders/page.tsx`),{__esModule:i,$$typeof:l}=a,d=a.default,n=d}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[214,896,594,554],()=>__webpack_exec__(9348));module.exports=s})();