(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{5871:function(e,t,n){Promise.resolve().then(n.bind(n,9080)),Promise.resolve().then(n.t.bind(n,3925,23)),Promise.resolve().then(n.t.bind(n,2853,23))},9080:function(e,t,n){"use strict";n.r(t),n.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var i=n(7437),u=n(2265),a=n(4421);let s=(0,u.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[n,r]=(0,u.useState)(null),[l,o]=(0,u.useState)(!0),[c,d]=(0,u.useState)(!1),[h,m]=(0,u.useState)(null),f=(0,a.e)();(0,u.useEffect)(()=>{let getInitialSession=async()=>{var e;let{data:{session:t}}=await f.auth.getSession();r(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null),(null==t?void 0:t.user)&&await checkAdminStatus(t.user),o(!1)};getInitialSession();let{data:{subscription:e}}=f.auth.onAuthStateChange(async(e,t)=>{var n;r(null!==(n=null==t?void 0:t.user)&&void 0!==n?n:null),(null==t?void 0:t.user)?await checkAdminStatus(t.user):(d(!1),m(null)),o(!1)});return()=>e.unsubscribe()},[f.auth]);let checkAdminStatus=async e=>{try{var t,n;let i=(null===(t=e.user_metadata)||void 0===t?void 0:t.role)||(null===(n=e.app_metadata)||void 0===n?void 0:n.role);"admin"===i||"super_admin"===i?(d(!0),m(i)):(d(!1),m(null))}catch(e){console.error("Error checking admin status:",e),d(!1),m(null)}},signIn=async(e,t)=>{let{error:n}=await f.auth.signInWithPassword({email:e,password:t});if(n)throw n},signUp=async(e,t)=>{let{error:n}=await f.auth.signUp({email:e,password:t});if(n)throw n},signOut=async()=>{let{error:e}=await f.auth.signOut();if(e)throw e};return(0,i.jsx)(s.Provider,{value:{user:n,loading:l,isAdmin:c,adminRole:h,hasPermission:e=>{if(!c)return!1;let t={view_dashboard:["admin","super_admin"],manage_products:["admin","super_admin"],manage_orders:["admin","super_admin"],manage_users:["super_admin"]}[e];return!!t&&t.includes(h||"")},signIn,signUp,signOut},children:t})}function useAuth(){let e=(0,u.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},4421:function(e,t,n){"use strict";n.d(t,{e:function(){return createClient}});var i=n(359);let createClient=()=>(0,i.eI)("https://qfauegckhmekucaaimvc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFmYXVlZ2NraG1la3VjYWFpbXZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3NTU1NDQsImV4cCI6MjA3NjMzMTU0NH0.lQ0kocnt67d_R485Cn3ZqT9m3VxXfy7n_L4HyoRlZIE")},2853:function(){},3925:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[673,971,472,744],function(){return e(e.s=5871)}),_N_E=e.O()}]);